# 2026-02-20T16:53 — Kujan (SDK Expert)

**Agent:** Kujan  
**Mode:** background  
**Outcome:** completed  

## Work Summary

Wrote 4 PRDs for the SDK Replatform documentation sprint, grounded in verified SDK source code (nodejs/src/types.ts, session.ts, client.ts, generated/session-events.ts):
- `06-streaming-observability.md` — PRD 6: Cost data native in assistant.usage (cost field) and session.shutdown (modelMetrics). JSONL format for event persistence (append-only log). Streamer for live display.
- `09-byok-multi-provider.md` — PRD 9: Tier-based model aliases (fast/standard/premium). SDK resolution at spawn time. Same charter works across Copilot, Azure, Anthropic. Fallback chains. Health cache.
- `10-mcp-server-integration.md` — PRD 10: Per-agent MCP via SDK's customAgents[].mcpServers. Zero custom Squad code. Tool filtering via include-list. Squad as MCP server (Phase 2).
- `12-distribution-install.md` — PRD 12: esbuild bundling with embedded templates (text loader, single-file dist, no templates/ in npm). In-Copilot install via .agent.md (Phase 1). Marketplace (Phase 2).

## Key Decisions

1. **Cost tracking:** SDK provides native cost data — simplifies PRD 6 significantly. JSONL for event logs (streamable, greppable, no deps).
2. **Secrets pattern:** `${VAR}` syntax for all config files (providers.json, mcp-config.json). Environment resolution at runtime. Safe to commit.
3. **Model aliases:** fast/standard/premium instead of model names. Provider-specific resolution at spawn. Single charter across all providers.
4. **Per-agent MCP:** SDK natively supports customAgents[].mcpServers. Tool filtering via include-list. Zero custom code needed.
5. **Bundling strategy:** esbuild with text loader for embedded templates. Single-file distribution. SDK as external (cannot bundle — native deps, process spawning).
6. **Installation:** In-Copilot .agent.md user runs npx. Marketplace registration Phase 2 when available.

## Pending Decisions (Need Brady Input)

1. npm package name: `@bradygaster/squad` vs. `create-squad` vs. `@squad/cli`?
2. Fallback chain behavior: config-driven explicit vs. automatic provider failure detection?
3. Per-agent provider override: allow charters to specify preferred provider?
4. Quota-aware routing: auto-switch provider when Copilot quota drops?
5. OpenTelemetry export: add OTLP for enterprise dashboards, or JSONL-only for now?

## Status

PRDs **Draft** — awaiting Brady review.
