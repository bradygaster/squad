# Orchestration Log: Kujan Spike Research

**Timestamp:** 2026-02-21T0449  
**Agent:** Kujan (Copilot SDK Expert)  
**Mode:** Background  
**Status:** âœ… Completed

## Work Summary

Executed four parallel SDK investigation spikes covering critical SDK constraints and patterns:

### Spike #66: Per-Agent Model Selection Architecture
- **Finding:** SDK has NO per-agent model field; model selection is session-scoped only
- **Constraint:** Per-agent models require multiple sessions (one session per model tier)
- **Recommendation:** Multi-session architecture with Opus/Sonnet/Haiku tiers
- **Deliverable:** Proposed `SquadSessionManager` class design
- **Issue:** bradygaster/squad-pr#66 (findings posted)

### Spike #67: Compaction Behavior and Workspace Persistence
- **Finding:** Checkpoints, `plan.md`, and `files/` directory survive background compaction
- **Thresholds:** 80% (background), 95% (emergency block)
- **Cost:** ~$0.10 per compaction event
- **Recommendation:** Monitor compaction frequency; adjust thresholds for long sessions
- **Issue:** bradygaster/squad-pr#67 (findings posted)

### Spike #70: Rate Limiting and Backpressure Architecture
- **Finding:** SDK has ZERO built-in rate limiting, retry logic, or backpressure
- **Constraint:** Squad must implement application-level rate limiting for 5+ concurrent agents
- **Recommendation:** Global rate limiter with per-session wrapper patterns
- **Issue:** bradygaster/squad-pr#70 (findings posted)

### Spike #71: Usage Telemetry and Real-Time Event Capture
- **Finding:** `assistant.usage` events are ephemeral (not persisted in history)
- **Constraint:** Squad must capture events in real-time via listeners
- **Recommendation:** SQLite schema for usage events + session summaries
- **Deliverable:** `SquadTelemetry` class design with cost budgeting patterns
- **Issue:** bradygaster/squad-pr#71 (findings posted)

## Decisions Created

Four decision files merged to `.ai-team/decisions.md`:
1. `kujan-spike-66-model-selection.md`
2. `kujan-spike-67-compaction.md`
3. `kujan-spike-70-rate-limiting.md`
4. `kujan-spike-71-telemetry.md`

## Key Outcomes

- SDK constraints catalogued; no blocking issues identified
- Implementation patterns provided for model selection, rate limiting, telemetry
- All findings posted to GitHub issues (bradygaster/squad-pr)
- Decision records created for future reference

---

**End of Log**
